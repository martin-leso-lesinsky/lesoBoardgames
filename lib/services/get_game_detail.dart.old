import 'package:http/http.dart' as http;
import 'package:xml/xml.dart' as xml;

class GameDetail {
  final String gameId;
  final String name;
  final int itemCount; // New property for item count

  GameDetail(this.gameId, this.name, this.itemCount);
}

class GetGameDetail {
  static const _baseUrl =
      'https://boardgamegeek.com/xmlapi2/thing?type=boardgame&versions=1&stats=1&id=';
  static Future<GameDetail> fetchGameDetail(String gameId) async {
    final response = await http.get(Uri.parse(_baseUrl));
    final xmlDocument = xml.parse(response.body);
    final itemElement = xmlDocument.findAllElements('item').first;
    final gameId = itemElement.getAttribute('id');
    final nameElement = itemElement.findElements('name').first;
    final name = nameElement.getAttribute('value');

    final itemCount = itemElement
        .findElements('link')
        .where((link) => link.getAttribute('type') == 'boardgameexpansion')
        .length;
    // Extract other properties from the XML response

    final gameDetail = GameDetail(gameId!, name!, itemCount);
    return gameDetail;
  }
}
